<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pinfolio Dashboard</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
:root {
  --bg: #f2ede5;
  --panel: #ffffff;
  --accent: #b8a98f;
  --dark: #2a2a2a;
  --muted: #777;
  --radius: 16px;
  --shadow: rgba(0,0,0,0.08);
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'Poppins', sans-serif;
  background: var(--bg);
  display: flex;
  height: 100vh;
  color: var(--dark);
}

/* SIDEBAR */
.sidebar {
  width: 260px;
  background: var(--panel);
  padding: 30px 20px;
  box-shadow: 5px 0 20px var(--shadow);
  display: flex;
  flex-direction: column;
}

.sidebar h2 {
  text-align: center;
  margin-bottom: 40px;
  letter-spacing: 2px;
}

.sidebar button {
  margin-bottom: 15px;
  padding: 14px;
  border: none;
  border-radius: 12px;
  background: #f5f2ec;
  color: var(--dark);
  font-weight: 600;
  cursor: pointer;
  transition: 0.3s;
  text-align: left;
}

.sidebar button.active,
.sidebar button:hover {
  background: var(--accent);
  color: white;
}

/* MAIN */
.main {
  flex: 1;
  padding: 35px;
  overflow-y: auto;
}

.section { display: none; }
.section.active { display: block; }

h2 {
  font-size: 1.8rem;
  margin-bottom: 25px;
  font-weight: 700;
}

/* PRODUCT GRID */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 25px;
}

.card {
  background: var(--panel);
  border-radius: var(--radius);
  box-shadow: 0 8px 25px var(--shadow);
  padding: 15px;
  cursor: pointer;
  transition: 0.3s;
  text-align: center;
}

.card:hover {
  transform: translateY(-6px);
  box-shadow: 0 15px 35px rgba(0,0,0,0.12);
}

.card img {
  width: 100%;
  height: 180px;
  object-fit: contain;      /* ðŸ”¥ FULL IMAGE, NO CUT */
  background: #fafafa;
  border-radius: 10px;
  padding: 10px;
}

.card h4 {
  margin-top: 12px;
  font-size: 1rem;
  font-weight: 600;
}

/* ADD PRODUCT FORM */
.form-box {
  background: var(--panel);
  max-width: 500px;
  padding: 30px;
  border-radius: var(--radius);
  box-shadow: 0 10px 30px var(--shadow);
}

.form-box input, .form-box textarea {
  width: 100%;
  padding: 12px;
  margin-bottom: 15px;
  border-radius: 12px;
  border: 1px solid #ccc;
  font-size: 1rem;
}

.form-box button {
  width: 100%;
  padding: 12px;
  background: var(--accent);
  color: white;
  border: none;
  border-radius: 30px;
  font-weight: 600;
  cursor: pointer;
}

/* ANALYTICS */
.stat {
  background: var(--panel);
  padding: 35px;
  max-width: 300px;
  border-radius: var(--radius);
  box-shadow: 0 10px 30px var(--shadow);
  text-align: center;
}
.stat h1 { font-size: 3rem; }
.stat p { color: var(--muted); }

/* MODAL */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.modal-box {
  background: var(--panel);
  width: 800px;
  max-width: 95%;
  border-radius: 16px;
  padding: 25px;
  display: flex;
  gap: 25px;
  position: relative;
}

.modal img {
  width: 40%;
  object-fit: contain;
  background: #f7f7f7;
  border-radius: 12px;
  padding: 15px;
}

.modal .details {
  flex: 1;
}

.modal h3 {
  font-size: 1.6rem;
  margin-bottom: 10px;
}

.modal p {
  color: var(--muted);
  margin-bottom: 20px;
  line-height: 1.6;
}

.modal a {
  display: inline-block;
  padding: 10px 20px;
  background: var(--accent);
  color: white;
  border-radius: 25px;
  text-decoration: none;
  margin-bottom: 20px;
}

.actions button {
  padding: 10px 15px;
  border: none;
  border-radius: 8px;
  margin-right: 10px;
  cursor: pointer;
}

.delete { background: #ef4444; color: white; }
.toggle { background: #444; color: white; }

.close {
  position: absolute;
  top: 10px;
  right: 15px;
  font-size: 1.5rem;
  cursor: pointer;
}
</style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar">
  <h2>PINFOLIO</h2>
  <button id="btnProducts" class="active" onclick="show('products')">Products</button>
  <button id="btnAdd" onclick="show('add')">Add Product</button>
  <button id="btnAnalytics" onclick="show('analytics')">Analytics</button>
</div>

<!-- MAIN -->
<div class="main">

  <!-- PRODUCTS -->
  <div id="products" class="section active">
    <h2>Products</h2>
    <div class="grid" id="productGrid"></div>
  </div>

  <!-- ADD -->
  <div id="add" class="section">
    <h2>Add Product</h2>
    <div class="form-box">
      <input type="text" id="title" placeholder="Product Title">
      <textarea id="desc" placeholder="Description"></textarea>
      <input type="text" id="link" placeholder="Product Link">
      <input type="text" id="image" placeholder="Image URL">
      <button onclick="addProduct()">Add Product</button>
      <p id="msg"></p>
    </div>
  </div>

  <!-- ANALYTICS -->
  <div id="analytics" class="section">
    <h2>Analytics</h2>
    <div class="stat">
      <h1 id="totalProducts">0</h1>
      <p>Total Products</p>
    </div>
  </div>

</div>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-box">
    <span class="close" onclick="modal.style.display='none'">&times;</span>
    <img id="modalImg">
    <div class="details">
      <h3 id="modalTitle"></h3>
      <p id="modalDesc"></p>
      <a id="modalLink" target="_blank">Open Product</a>

      <div class="actions">
        <button class="delete" id="deleteBtn">Delete</button>
        <button class="toggle" id="toggleBtn">Hide</button>
      </div>
    </div>
  </div>
</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, deleteDoc, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCaIDSNGdwZs3VJk5gVbvb6UGeKP6u5dx8",
  authDomain: "pinfolio-55246.firebaseapp.com",
  projectId: "pinfolio-55246",
  storageBucket: "pinfolio-55246.appspot.com",
  messagingSenderId: "864326590674",
  appId: "1:864326590674:web:7e4ec37e91f0ac92c2cd0b"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const grid = document.getElementById("productGrid");
const modal = document.getElementById("modal");
const modalImg = document.getElementById("modalImg");
const modalTitle = document.getElementById("modalTitle");
const modalDesc = document.getElementById("modalDesc");
const modalLink = document.getElementById("modalLink");
const deleteBtn = document.getElementById("deleteBtn");
const toggleBtn = document.getElementById("toggleBtn");
const totalProducts = document.getElementById("totalProducts");

/* NAV */
window.show = (id) => {
  document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
  document.querySelectorAll(".sidebar button").forEach(b => b.classList.remove("active"));
  document.getElementById(id).classList.add("active");

  if (id === "products") btnProducts.classList.add("active");
  if (id === "add") btnAdd.classList.add("active");
  if (id === "analytics") btnAnalytics.classList.add("active");
};

/* LOAD PRODUCTS */
onSnapshot(collection(db,"products"), (snapshot) => {
  grid.innerHTML = "";
  totalProducts.innerText = snapshot.size;

  snapshot.forEach(docSnap => {
    const p = docSnap.data();

    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <img src="${p.image}">
      <h4>${p.title}</h4>
    `;

    card.onclick = () => openModal(docSnap.id, p);
    grid.appendChild(card);
  });
});

/* MODAL */
function openModal(id, p) {
  modalImg.src = p.image;
  modalTitle.textContent = p.title;
  modalDesc.textContent = p.desc || "No description available.";
  modalLink.href = p.link || "#";
  toggleBtn.textContent = p.show === false ? "Show" : "Hide";

  deleteBtn.onclick = () => deleteProduct(id);
  toggleBtn.onclick = () => toggleShow(id, p.show !== false);

  modal.style.display = "flex";
}

/* ADD PRODUCT */
window.addProduct = async () => {
  const title = document.getElementById("title").value;
  const desc = document.getElementById("desc").value;
  const link = document.getElementById("link").value;
  const image = document.getElementById("image").value;

  if (!title || !image) return alert("Title & Image required");

  await addDoc(collection(db,"products"), { title, desc, link, image, show:true });

  alert("Product Added!");
};

/* DELETE */
async function deleteProduct(id) {
  if (confirm("Delete this product?")) {
    await deleteDoc(doc(db,"products",id));
    modal.style.display="none";
  }
}

/* SHOW / HIDE */
async function toggleShow(id,current) {
  await updateDoc(doc(db,"products",id), { show: !current });
  modal.style.display="none";
}
</script>

</body>
</html>
